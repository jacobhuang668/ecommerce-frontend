{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import{useSelector,useDispatch}from\"react-redux\";import{listProducts}from\"../actions/productActions\";function HomeScreen(props){const[searchKeyword,setSearchKeyword]=useState(\"\");const[sortOrder,setSortOrder]=useState(\"\");const category=props.match.params.id?props.match.params.id:\"\";const productList=useSelector(state=>state.productList);const{loading,products,error}=productList;console.log(\"products:\",products);const dispatch=useDispatch();useEffect(()=>{//进入action creator\ndispatch(listProducts(category,\"\",sortOrder));return()=>{//nothing to do\n//你可能认为 sortOrder 始终是旧值，但实际上 useEffect 回调中使用的是最新值。\n//清理函数的打印只是反映了上一次的状态。\n};},[category,sortOrder]);const submitHandler=e=>{e.preventDefault();dispatch(listProducts(category,searchKeyword,sortOrder));};return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"ul\",{className:\"filter\"},/*#__PURE__*/React.createElement(\"li\",null,/*#__PURE__*/React.createElement(\"form\",{onSubmit:submitHandler},/*#__PURE__*/React.createElement(\"input\",{onChange:e=>{setSearchKeyword(e.target.value);}}),/*#__PURE__*/React.createElement(\"button\",null,\"search\"))),/*#__PURE__*/React.createElement(\"li\",null,\"Sort By\",\" \",/*#__PURE__*/React.createElement(\"select\",{value:sortOrder,onChange:e=>{setSortOrder(e.target.value);}},/*#__PURE__*/React.createElement(\"option\",{value:\"\"},\"Newest\"),/*#__PURE__*/React.createElement(\"option\",{value:\"lowest\"},\"Lowest\"),/*#__PURE__*/React.createElement(\"option\",{value:\"highest\"},\"Highest\")))),loading?/*#__PURE__*/React.createElement(\"div\",null,\"Loading....\"):error?/*#__PURE__*/React.createElement(\"div\",null,error):/*#__PURE__*/React.createElement(\"ul\",{className:\"products\"},products.map(product=>{return/*#__PURE__*/React.createElement(\"li\",{key:product._id},/*#__PURE__*/React.createElement(\"div\",{className:\"product\"},/*#__PURE__*/React.createElement(\"img\",{className:\"product-image\",src:`localhost:8080/${product.image}`,alt:\"product\"}),/*#__PURE__*/React.createElement(\"div\",{className:\"product-name\"},product.name),/*#__PURE__*/React.createElement(\"div\",{className:\"product-brand\"},product.brand),/*#__PURE__*/React.createElement(\"div\",{className:\"product-price\"},product.price)));})));}export default HomeScreen;","map":{"version":3,"names":["React","useState","useEffect","useSelector","useDispatch","listProducts","HomeScreen","props","searchKeyword","setSearchKeyword","sortOrder","setSortOrder","category","match","params","id","productList","state","loading","products","error","console","log","dispatch","submitHandler","e","preventDefault","createElement","Fragment","className","onSubmit","onChange","target","value","map","product","key","_id","src","image","alt","name","brand","price"],"sources":["/Users/huanghuangjian/Documents/frontend-learning/react/ecommerce-frontend/src/screens/HomeScreen.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { listProducts } from \"../actions/productActions\";\nfunction HomeScreen(props) {\n  const [searchKeyword, setSearchKeyword] = useState(\"\");\n  const [sortOrder, setSortOrder] = useState(\"\");\n  const category = props.match.params.id ? props.match.params.id : \"\";\n  const productList = useSelector((state) => state.productList);\n  const { loading, products, error } = productList;\n  console.log(\"products:\", products);\n  const dispatch = useDispatch();\n  useEffect(() => {\n    //进入action creator\n    dispatch(listProducts(category, \"\", sortOrder));\n    return () => {\n      //nothing to do\n      //你可能认为 sortOrder 始终是旧值，但实际上 useEffect 回调中使用的是最新值。\n      //清理函数的打印只是反映了上一次的状态。\n    };\n  }, [category, sortOrder]);\n  const submitHandler = (e) => {\n    e.preventDefault();\n    dispatch(listProducts(category, searchKeyword, sortOrder));\n  };\n\n  return (\n    <>\n      <ul className=\"filter\">\n        <li>\n          <form onSubmit={submitHandler}>\n            <input\n              onChange={(e) => {\n                setSearchKeyword(e.target.value);\n              }}\n            ></input>\n            <button>search</button>\n          </form>\n        </li>\n        <li>\n          Sort By{\" \"}\n          <select\n            value={sortOrder}\n            onChange={(e) => {\n              setSortOrder(e.target.value);\n            }}\n          >\n            <option value=\"\">Newest</option>\n            <option value=\"lowest\">Lowest</option>\n            <option value=\"highest\">Highest</option>\n          </select>\n        </li>\n      </ul>\n      {loading ? (\n        <div>Loading....</div>\n      ) : error ? (\n        <div>{error}</div>\n      ) : (\n        <ul className=\"products\">\n          {products.map((product) => {\n            return (\n              <li key={product._id}>\n                <div className=\"product\">\n                  <img\n                    className=\"product-image\"\n                    src={`localhost:8080/${product.image}`}\n                    alt=\"product\"\n                  ></img>\n                  <div className=\"product-name\">{product.name}</div>\n                  <div className=\"product-brand\">{product.brand}</div>\n                  <div className=\"product-price\">{product.price}</div>\n                </div>\n              </li>\n            );\n          })}\n        </ul>\n      )}\n    </>\n  );\n}\nexport default HomeScreen;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}